generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

// -----------------------------------------------------------------------------
// CORE & MULTI-TENANT
// -----------------------------------------------------------------------------

model Tenant {
  id             String  @id @default(uuid())
  name           String
  address        String?
  phone          String?
  adminUserId    String?
  timezone       String  @default("Asia/Jakarta")
  plan           String  @default("BASIC") // BASIC, PRO, ENTERPRISE
  billingContact String?
  status         String  @default("ACTIVE") // ACTIVE, SUSPENDED, INACTIVE
  settings       String? // JSON string

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  users         User[]
  santri        Santri[]
  wali          Wali[]
  izin          Izin[]
  catatanHarian CatatanHarian[]
  pengumuman    Pengumuman[]
  invoices      Invoice[]
  pelanggaran   Pelanggaran[]
  pembinaan     Pembinaan[]
  kunjungan     Kunjungan[]
  healthRecords HealthRecord[]
  auditLogs     AuditLog[]
  notifications Notification[]
  webhookEvents WebhookEvent[]

  // Tenants Relations for ERP Extension
  tahfidz        Tahfidz[]
  mutabaah       Mutabaah[]
  wallets        Wallet[]
  employees      Employee[]
  payrolls       Payroll[]
  academicScheds AcademicSchedule[]
  attendances    Attendance[]
  grades         Grade[]

  // Tenants Relations for Phase 12 (Advanced ERP)
  ppdbRegistrations     PpdbRegistration[]
  ppdbDocuments         PpdbDocument[]
  ppdbExams             PpdbExam[]
  inventoryItems        Item[]
  inventoryTransactions InventoryTransaction[]
  suppliers             Supplier[]
  purchaseOrders        PurchaseOrder[]
  buildings             Building[]
  rooms                 Room[]
  roomAssignments       RoomAssignment[]
  maintenanceTickets    MaintenanceTicket[]

  @@map("tenants")
}

model User {
  id       String  @id @default(uuid())
  tenantId String?
  tenant   Tenant? @relation(fields: [tenantId], references: [id])

  email        String  @unique
  passwordHash String
  role         String  @default("PENGURUS") // SUPERADMIN, TENANT_ADMIN, PENGURUS, MUSYRIF, GURU, KESEHATAN
  name         String
  phone        String?

  isActive  Boolean   @default(true)
  lastLogin DateTime?
  fcmTokens String?   // JSON Array of device tokens

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  refreshTokens RefreshToken[]
  auditLogs     AuditLog[]
  notifications Notification[]

  @@index([tenantId])
  @@map("users")
}

model RefreshToken {
  id        String   @id @default(uuid())
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  token     String   @unique
  expiresAt DateTime
  revoked   Boolean  @default(false)

  createdAt DateTime @default(now())

  @@index([userId])
  @@map("refresh_tokens")
}

model Santri {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  nisn    String?
  name    String
  gender  String // L or P
  dob     DateTime?
  kelas   String?
  room    String?
  contact String?
  address String?
  photo   String?
  status  String    @default("AKTIF") // AKTIF, LULUS, MUTASI, NONAKTIF

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  walis         SantriWali[]
  izin          Izin[]
  catatanHarian CatatanHarian[]
  invoices      Invoice[]
  pelanggaran   Pelanggaran[]
  pembinaan     Pembinaan[]
  kunjungan     Kunjungan[]
  healthRecords HealthRecord[]
  medications   Medication[]

  // Back-relations for ERP Extension
  tahfidz     Tahfidz[]    @relation("TahfidzToSantri")
  mutabaah    Mutabaah[]   @relation("MutabaahToSantri")
  wallet      Wallet?      @relation("WalletToSantri")
  attendances Attendance[] @relation("AttendanceToSantri")
  grades      Grade[]      @relation("GradeToSantri")

  @@index([tenantId])
  @@map("santri")
}

model Wali {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  name     String
  relation String
  phone    String
  email    String?
  address  String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  santris SantriWali[]

  @@index([tenantId])
  @@map("wali")
}

model SantriWali {
  santriId String
  santri   Santri @relation(fields: [santriId], references: [id], onDelete: Cascade)

  waliId String
  wali   Wali   @relation(fields: [waliId], references: [id], onDelete: Cascade)

  isPrimary Boolean @default(false)

  @@id([santriId, waliId])
  @@map("santri_wali")
}

model Izin {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  santriId String
  santri   Santri @relation(fields: [santriId], references: [id], onDelete: Cascade)

  type    String // KELUAR, SAKIT, PULANG
  reason  String
  startAt DateTime
  endAt   DateTime

  status String @default("PENDING") // PENDING, APPROVED, REJECTED, CHECKED_OUT, CHECKED_IN, EXPIRED

  requestedBy String
  approvedBy  String?
  approvedAt  DateTime?

  qrCodeData String? @unique

  checkoutAt DateTime?
  checkoutBy String?
  checkinAt  DateTime?
  checkinBy  String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([tenantId])
  @@index([santriId])
  @@map("izin")
}

model CatatanHarian {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  santriId String
  santri   Santri @relation(fields: [santriId], references: [id], onDelete: Cascade)

  authorId String
  date     DateTime @default(now())

  content     String
  category    String
  attachments String? // JSON string

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([tenantId])
  @@index([santriId])
  @@map("catatan_harian")
}

model Pengumuman {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  title       String
  content     String
  audience    String
  pinnedUntil DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([tenantId])
  @@map("pengumuman")
}

model Invoice {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  santriId String
  santri   Santri @relation(fields: [santriId], references: [id], onDelete: Cascade)

  amountDue Float
  dueDate   DateTime
  status    String   @default("UNPAID") // UNPAID, PARTIAL, PAID, CANCELLED

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  lines    InvoiceLine[]
  payments Payment[]

  @@index([tenantId])
  @@index([santriId])
  @@map("invoices")
}

model InvoiceLine {
  id        String  @id @default(uuid())
  invoiceId String
  invoice   Invoice @relation(fields: [invoiceId], references: [id], onDelete: Cascade)

  description String
  amount      Float
  type        String

  @@index([invoiceId])
  @@map("invoice_lines")
}

model Payment {
  id        String  @id @default(uuid())
  invoiceId String
  invoice   Invoice @relation(fields: [invoiceId], references: [id], onDelete: Cascade)

  method         String
  amount         Float
  status         String    @default("PENDING") // PENDING, SUCCESS, FAILED, REFUNDED
  transactionRef String?
  paidAt         DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([invoiceId])
  @@map("payments")
}

model Pelanggaran {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  santriId String
  santri   Santri @relation(fields: [santriId], references: [id], onDelete: Cascade)

  recordedBy  String
  category    String
  severity    Int
  points      Int      @default(0)
  description String
  date        DateTime @default(now())
  resolved    Boolean  @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([tenantId])
  @@index([santriId])
  @@map("pelanggaran")
}

model Pembinaan {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  santriId String
  santri   Santri @relation(fields: [santriId], references: [id], onDelete: Cascade)

  plan       String
  targetDate DateTime
  status     String   @default("ONGOING") // ONGOING, COMPLETED, FAILED
  assignedTo String

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([tenantId])
  @@index([santriId])
  @@map("pembinaan")
}

model Kunjungan {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  santriId String
  santri   Santri @relation(fields: [santriId], references: [id], onDelete: Cascade)

  scheduledAt  DateTime
  slot         String
  visitorLimit Int      @default(2)
  status       String   @default("SCHEDULED") // SCHEDULED, CHECKED_IN, COMPLETED, CANCELLED

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  tamu Tamu[]

  @@index([tenantId])
  @@index([santriId])
  @@map("kunjungan")
}

model Tamu {
  id          String    @id @default(uuid())
  kunjunganId String
  kunjungan   Kunjungan @relation(fields: [kunjunganId], references: [id], onDelete: Cascade)

  name      String
  phone     String?
  idNumber  String?
  checkinAt DateTime?

  createdAt DateTime @default(now())

  @@index([kunjunganId])
  @@map("tamu")
}

model HealthRecord {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  santriId String
  santri   Santri @relation(fields: [santriId], references: [id], onDelete: Cascade)

  recordedBy  String
  symptoms    String
  diagnosis   String?
  actionTaken String?
  referred    Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([tenantId])
  @@index([santriId])
  @@map("health_records")
}

model Medication {
  id       String @id @default(uuid())
  santriId String
  santri   Santri @relation(fields: [santriId], references: [id], onDelete: Cascade)

  medicineName String
  dose         String
  schedule     String
  givenBy      String?
  givenAt      DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([santriId])
  @@map("medications")
}

model AuditLog {
  id       String  @id @default(uuid())
  tenantId String?
  tenant   Tenant? @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  userId String?
  user   User?   @relation(fields: [userId], references: [id], onDelete: SetNull)

  action   String
  entity   String
  entityId String

  oldValue String? // JSON string
  newValue String? // JSON string

  ip String?

  createdAt DateTime @default(now())

  @@index([tenantId])
  @@index([entity, entityId])
  @@map("audit_logs")
}

model Notification {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  userId String
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  type  String
  title String
  body  String
  read  Boolean @default(false)

  createdAt DateTime @default(now())

  @@index([tenantId])
  @@index([userId])
  @@map("notifications")
}

model WebhookEvent {
  id       String  @id @default(uuid())
  tenantId String?
  tenant   Tenant? @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  eventType String
  payload   String // JSON string
  status    String  @default("PENDING") // PENDING, SUCCESS, FAILED
  error     String?

  createdAt   DateTime  @default(now())
  processedAt DateTime?

  @@index([tenantId])
  @@index([status])
  @@map("webhook_events")
}

// -----------------------------------------------------------------------------
// ERP EXTENSION: TAHFIDZ, AKADEMIK, UANG SAKU, HR
// -----------------------------------------------------------------------------

model Tahfidz {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  santriId String
  santri   Santri @relation("TahfidzToSantri", fields: [santriId], references: [id], onDelete: Cascade)

  surah String // Nama Surah atau Juz
  ayat  String? // Rentang Ayat
  type  String  @default("ZIYADAH") // ZIYADAH, MUROJAAH, SABAQ
  grade String? // Nilai Mutu (A, B, C / Jayyid, Mumtaz dsb)
  notes String?

  recordedBy String // ID Musyrif/Guru
  date       DateTime @default(now())

  createdAt DateTime @default(now())

  @@index([tenantId])
  @@index([santriId])
  @@map("tahfidz")
}

model Mutabaah {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  santriId String
  santri   Santri @relation("MutabaahToSantri", fields: [santriId], references: [id], onDelete: Cascade)

  date DateTime @default(now())

  sholatWajib Boolean @default(true) // Berjamaah / Tepat waktu
  tahajud     Boolean @default(false)
  dhuha       Boolean @default(false)
  puasaSunnah Boolean @default(false)
  bacaQuran   Boolean @default(true)

  notes      String?
  recordedBy String? // UUID User pemeriksa/pengisi

  createdAt DateTime @default(now())

  @@index([tenantId])
  @@index([santriId, date])
  @@map("mutabaah")
}

model Wallet {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  santriId String @unique
  santri   Santri @relation("WalletToSantri", fields: [santriId], references: [id], onDelete: Cascade)

  balance  Float   @default(0)
  pin      String? // Hashed PIN untuk transaksi
  isActive Boolean @default(true)

  updatedAt DateTime @updatedAt

  transactions WalletTransaction[]

  @@index([tenantId])
  @@map("wallets")
}

model WalletTransaction {
  id       String @id @default(uuid())
  walletId String
  wallet   Wallet @relation(fields: [walletId], references: [id], onDelete: Cascade)

  amount      Float
  type        String // DEPOSIT, WITHDRAWAL, PAYMENT
  method      String // CASH, TRANSFER, VIRTUAL_ACCOUNT
  description String?

  reference String? // ID referensi eksternal (VA / Invoice ID)
  status    String  @default("SUCCESS") // PENDING, SUCCESS, FAILED
  handledBy String? // UUID Petugas Kasir/Admin

  createdAt DateTime @default(now())

  @@index([walletId])
  @@map("wallet_transactions")
}

model Employee {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  userId String? @unique // Dapat ditautkan dengan tabel User Login jika ia pengguna aplikasi

  nip      String? // Nomor Induk Pegawai
  name     String
  position String // GURU, MUSYRIF, STAF, SECURITY
  phone    String?
  address  String?
  joinDate DateTime?
  status   String    @default("AKTIF")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  payrolls Payroll[]

  @@index([tenantId])
  @@map("employees")
}

model Payroll {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  employeeId String
  employee   Employee @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  month Int
  year  Int

  baseSalary Float @default(0)
  allowances Float @default(0)
  deductions Float @default(0)
  netAmount  Float

  status String    @default("DRAFT") // DRAFT, PAID
  paidAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([tenantId])
  @@index([employeeId])
  @@map("payrolls")
}

model AcademicSchedule {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  subject   String
  teacherId String // NIP atau UUID Employee
  kelas     String
  dayOfWeek Int // 1=Monday, 2=Tuesday, dll
  startTime String // Format "07:00"
  endTime   String // Format "08:30"
  room      String?

  createdAt DateTime @default(now())

  @@index([tenantId])
  @@map("academic_schedules")
}

model Attendance {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  santriId String
  santri   Santri @relation("AttendanceToSantri", fields: [santriId], references: [id], onDelete: Cascade)

  scheduleId String? // Refference ke AcademicSchedule jika diperlukan
  date       DateTime @default(now())
  status     String // HADIR, SAKIT, IZIN, ALPA
  notes      String?

  recordedBy String?

  createdAt DateTime @default(now())

  @@index([tenantId])
  @@index([santriId, date])
  @@map("attendances")
}

model Grade {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  santriId String
  santri   Santri @relation("GradeToSantri", fields: [santriId], references: [id], onDelete: Cascade)

  subject      String
  semester     String // GANJIL/GENAP
  academicYear String // e.g "2024/2025"

  type  String // UH, UTS, UAS, PRAKTEK
  score Float
  notes String?

  createdAt DateTime @default(now())

  @@index([tenantId])
  @@index([santriId])
  @@map("grades")
}

// -----------------------------------------------------------------------------
// PHASE 12: PPDB, INVENTORY & COOPERATIVE, DORMITORY
// -----------------------------------------------------------------------------

// --- PPDB (Penerimaan Peserta Didik Baru) ---
model PpdbRegistration {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  registrationNumber String @unique
  fullName           String
  gender             String // L or P
  dob                DateTime?
  previousSchool     String?
  pathway             String @default("REGULER") // REGULER, PRESTASI, MUTASI

  status   String @default("PENDING") // PENDING, DOCUMENTS_VERIFIED, EXAM_SCHEDULED, PASSED, FAILED, ACCEPTED
  notes    String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  documents PpdbDocument[]
  exams     PpdbExam[]

  @@index([tenantId])
  @@map("ppdb_registrations")
}

model PpdbDocument {
  id             String           @id @default(uuid())
  tenantId       String
  tenant         Tenant           @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  
  registrationId String
  registration   PpdbRegistration @relation(fields: [registrationId], references: [id], onDelete: Cascade)

  documentType String // KK, AKTA, IJAZAH, PASFOTO
  fileUrl      String // URL ke S3 atau lokal
  isVerified   Boolean @default(false)
  
  createdAt    DateTime @default(now())

  @@index([registrationId])
  @@map("ppdb_documents")
}

model PpdbExam {
  id             String           @id @default(uuid())
  tenantId       String
  tenant         Tenant           @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  
  registrationId String
  registration   PpdbRegistration @relation(fields: [registrationId], references: [id], onDelete: Cascade)

  examType  String   // TES_TULIS, TES_WAWANCARA, TES_BACA_QURAN
  examDate  DateTime
  score     Float?
  result    String?  // LULUS, TIDAK_LULUS
  interviewer String? 
  
  createdAt DateTime @default(now())

  @@index([registrationId])
  @@map("ppdb_exams")
}

// --- Manajemen Inventori & Koperasi ---
model Item {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  sku         String @unique
  name        String
  description String?
  category    String // SERAGAM, BUKU, ALAT_TULIS, MAKANAN
  
  price       Float  // Harga Jual
  costPrice   Float? // Harga Modal/Beli
  stock       Int    @default(0)
  minStock    Int    @default(5)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  transactions InventoryTransaction[]

  @@index([tenantId])
  @@map("items")
}

model InventoryTransaction {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  itemId String
  item   Item   @relation(fields: [itemId], references: [id], onDelete: Cascade)

  type        String // IN, OUT, ADJUSTMENT
  quantity    Int
  reference   String? // e.g: "Pembelian dari Toko A", "Kasir #1234"
  notes       String?
  handledBy   String? // ID staff/admin

  date        DateTime @default(now())

  @@index([tenantId])
  @@index([itemId])
  @@map("inventory_transactions")
}

model Supplier {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  name    String
  contact String?
  address String?
  email   String?
  
  createdAt DateTime @default(now())

  purchaseOrders PurchaseOrder[]

  @@index([tenantId])
  @@map("suppliers")
}

model PurchaseOrder {
  id         String   @id @default(uuid())
  tenantId   String
  tenant     Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  supplierId String
  supplier   Supplier @relation(fields: [supplierId], references: [id], onDelete: Cascade)

  poNumber   String   @unique
  totalCost  Float
  status     String   @default("DRAFT") // DRAFT, SENT, RECEIVED, PARTIAL, CANCELLED
  orderDate  DateTime @default(now())
  
  notes      String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([tenantId])
  @@map("purchase_orders")
}

// --- Manajemen Asrama (Dormitory) ---
model Building {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  name        String
  description String?
  gender      String  // L or P (Asrama Putra/Putri)
  capacity    Int     @default(0)

  rooms       Room[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([tenantId])
  @@map("buildings")
}

model Room {
  id         String   @id @default(uuid())
  tenantId   String
  tenant     Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  buildingId String
  building   Building @relation(fields: [buildingId], references: [id], onDelete: Cascade)

  name        String
  capacity    Int
  picName     String? // Musyrif/Musyrifah Penanggung Jawab

  assignments RoomAssignment[]
  tickets     MaintenanceTicket[]

  createdAt DateTime @default(now())

  @@index([tenantId])
  @@index([buildingId])
  @@map("rooms")
}

model RoomAssignment {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  roomId   String
  room     Room   @relation(fields: [roomId], references: [id], onDelete: Cascade)

  santriId String // Sengaja tidak hard-FK agar jika santri dihapus, riwayat kamarnya bisa tetap diakses jika butuh log, atau pakai string
  
  startDate DateTime @default(now())
  endDate   DateTime?
  status    String   @default("ACTIVE") // ACTIVE, MOVED, GRADUATED

  @@index([tenantId])
  @@index([roomId])
  @@map("room_assignments")
}

model MaintenanceTicket {
  id       String @id @default(uuid())
  tenantId String
  tenant   Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  roomId   String
  room     Room   @relation(fields: [roomId], references: [id], onDelete: Cascade)

  title       String
  description String
  priority    String @default("MEDIUM") // LOW, MEDIUM, HIGH, CRITICAL
  status      String @default("OPEN") // OPEN, IN_PROGRESS, RESOLVED, CLOSED
  
  reportedBy  String // UUID Pelapor
  resolvedAt  DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([tenantId])
  @@index([roomId])
  @@map("maintenance_tickets")
}
